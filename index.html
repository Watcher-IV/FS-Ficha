<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ficha Flagelo-Sombrio (Protótipo)</title>

  <!-- Fonts: Titulos, Texto e Numeros -->
  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Spectral:wght@300;400;600&family=VT323&display=swap" rel="stylesheet">

  <style>
    /* -----------------------------
       CONFIGURAÇÕES GLOBAIS
       ----------------------------- */
    :root{
      --accent: #eaeaea;
      --accent-2: #7b0000;
      --muted: #bbbbbb;
      --bg-image: url('background-template.jpg');
      --portrait-normal: url('portrait_normal.png');
      --portrait-injured: url('portrait_injured.png');
      --portrait-insane: url('portrait_insane.png');
    }

    /* reset / box sizing */
    *{box-sizing:border-box;}
    html,body{height:100%;margin:0;padding:0;overflow:hidden;} /* remove scrollbars da página */
    body{
      font-family: 'Spectral', serif;
      background:#080808;
      color:var(--accent);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      font-size:14px; /* escala geral reduzida */
    }

    /* Layout em três colunas fixas (ajustadas para caber) */
    .wrap{
      display:grid;
      grid-template-columns: 240px 1fr 300px; /* colunas estreitas para evitar overflow */
      gap:18px;
      padding:16px;
      height:100vh;
      align-items:start;
      min-width:0; /* evita overflow horizontal de children */
    }

    /* Painel esquerdo - Vital */
    .panel{
      background: rgba(0,0,0,0.6);
      border:1px solid rgba(255,255,255,0.03);
      padding:12px;
      box-sizing:border-box;
      height:calc(100vh - 32px);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      justify-content:flex-start;
    }

    .portrait{
      width:100%;
      height:480px; /* reduzido para encaixar */
      background-image:var(--portrait-normal);
      background-size:cover;
      background-position:center;
      border:1px solid rgba(255,255,255,0.04);
      margin-bottom:10px;
      flex-shrink:0;
    }

    .vitals{
      display:flex;
      gap:8px;
      justify-content:space-between;
      align-items:center;
      margin-top:auto;
    }

    .vital{
      flex:1;
      text-align:center;
      padding:8px 6px;
      border:1px dashed rgba(255,255,255,0.03);
      min-width:0;
    }

    .vital h4{font-family:'Cinzel Decorative', serif;margin:0 0 6px 0;font-size:15px;color:var(--accent);}
    .vital .number{font-family:'VT323', monospace;font-size:28px;color:var(--accent);}

    .small-btn{display:inline-block;padding:5px 7px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--muted);cursor:pointer;margin-top:6px;font-size:12px}

    /* Area central - a ficha (sem scroll interno) */
    .center{
      background: rgba(0,0,0,0.6);
      padding:12px;
      box-sizing:border-box;
      height:calc(100vh - 32px);
      overflow:hidden; /* sem barra lateral aqui conforme pedido */
      min-width:0; /* evita que conteúdo force overflow horizontal */
    }

    .heading{display:flex;justify-content:space-between;align-items:flex-start;gap:12px}
    .title{font-family:'Cinzel Decorative', serif;font-size:20px;margin-bottom:4px}
    .meta input{background:transparent;border:none;border-bottom:1px solid rgba(255,255,255,0.06);color:var(--accent);padding:6px 8px;width:200px;font-size:13px}

    /* Grid de atributos (ajustado) */
    .attrs{margin-top:12px;display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
    .attr{padding:10px;border:1px solid rgba(255,255,255,0.04);min-width:0}
    .attr h5{margin:0 0 6px 0;font-size:12px;color:var(--muted)}
    .attr .controls{display:flex;align-items:center;gap:6px}
    .attr .val{font-family:'VT323', monospace;font-size:18px;width:42px;text-align:center}
    .attr button{padding:5px 7px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--muted);cursor:pointer;font-size:12px}

    /* Perícias/Habilidades e campos textuais */
    .block{margin-top:12px}
    textarea{width:100%;min-height:68px;background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--accent);padding:8px;resize:vertical;font-size:13px}
    input[type=text]{width:100%;padding:8px;background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--accent);font-size:13px}

    /* Painel direito - Inventário */
    .inventory{
      background: rgba(0,0,0,0.6);
      padding:12px;
      box-sizing:border-box;
      height:calc(100vh - 32px);
      overflow:hidden; /* sem scroll lateral direito */
      display:flex;
      flex-direction:column;
    }
    .inv-list{list-style:none;padding:0;margin:0;flex:0 1 auto;overflow:auto;}
    .inv-item{display:flex;justify-content:space-between;padding:8px 6px;border-bottom:1px solid rgba(255,255,255,0.03);font-size:13px}
    .inv-add{margin-top:10px;display:flex;gap:8px}
    .inv-add input{flex:1;padding:7px;font-size:13px}

    /* Mensagens estranhas (aparecem somente quando PS baixo) */
    .strange-msg{margin-top:12px;padding:10px;border-left:3px solid var(--accent-2);color:var(--muted);display:none;font-size:13px}

    /* pequenos ajustes para evitar overflow horizontal em elementos internos */
    input, textarea, .attr, .panel, .inventory, .center {max-width:100%;}

    /* Responsividade reduzida (mantém tudo enquadrado) */
    @media(max-width:1200px){
      .wrap{grid-template-columns:220px 1fr 260px;gap:12px;padding:10px}
      .portrait{height:420px}
      .title{font-size:18px}
    }
    @media(max-width:980px){
      html,body{overflow:auto;} /* em telas bem pequenas permitimos scroll da página */
      .wrap{grid-template-columns:1fr;grid-auto-rows:min-content;padding:12px;}
      .portrait{height:320px}
      .center{overflow:visible}
      .inventory{overflow:visible;height:auto}
    }

    .hint{font-size:12px;color:var(--muted);margin-top:8px}
  </style>
</head>
<body>
  <div class="wrap">

    <!-- ESQUERDA: Painel Vital -->
    <aside class="panel">
      <div class="portrait" id="portrait" title="Retrato do personagem"></div>

      <div class="vitals">
        <div class="vital">
          <h4>PV</h4>
          <div class="number" id="pvDisplay">10</div>
          <div style="margin-top:8px">
            <button class="small-btn" id="pvMinus">-</button>
            <button class="small-btn" id="pvPlus">+</button>
          </div>
        </div>

        <div class="vital">
          <h4>PS</h4>
          <div class="number" id="psDisplay">50</div>
          <div style="margin-top:8px">
            <button class="small-btn" id="psMinus">-</button>
            <button class="small-btn" id="psPlus">+</button>
          </div>
        </div>

        <div class="vital">
          <h4>PT</h4>
          <div class="number" id="ptDisplay">6</div>
          <div style="margin-top:8px">
            <button class="small-btn" id="ptMinus">-</button>
            <button class="small-btn" id="ptPlus">+</button>
          </div>
        </div>
      </div>

      <div class="hint">Observação: PT aumenta até o limite. Se ultrapassa-lo terá consequências.</div>
    </aside>

    <!-- CENTRO: Ficha Principal -->
    <main class="center">
      <div class="heading">
        <div>
          <div class="title">Ficha — Flagelo Sombrio</div>
          <div style="font-size:12px;color:var(--muted);margin-top:6px">Preencha campos e ajuste os atributos. Tudo é calculado automaticamente.</div>
        </div>

        <div class="meta">
          <input id="nameField" placeholder="Nome do personagem" />
        </div>
      </div>

      <div class="block" style="margin-top:12px">
        <label style="display:block;margin-bottom:6px;color:var(--muted)">Informações</label>
        <input id="hometown" type="text" placeholder="Cidade natal" />
        <div style="height:8px"></div>
        <textarea id="origin" placeholder="Origem / Passado (escreva algo breve)"></textarea>
      </div>

      <div class="block">
        <label style="display:block;margin-bottom:8px;color:var(--muted)">Atributos (0 a 3)</label>
        <div class="attrs">
          <!-- FOR -->
          <div class="attr">
            <h5>FOR — Poder Físico</h5>
            <div class="controls">
              <button data-attr="FOR" class="attr-dec">-</button>
              <div class="val" id="FOR">0</div>
              <button data-attr="FOR" class="attr-inc">+</button>
            </div>
          </div>

          <!-- AGI -->
          <div class="attr">
            <h5>AGI — Velocidade e Precisão</h5>
            <div class="controls">
              <button data-attr="AGI" class="attr-dec">-</button>
              <div class="val" id="AGI">0</div>
              <button data-attr="AGI" class="attr-inc">+</button>
            </div>
          </div>

          <!-- VIG -->
          <div class="attr">
            <h5>VIG — Resistência Física</h5>
            <div class="controls">
              <button data-attr="VIG" class="attr-dec">-</button>
              <div class="val" id="VIG">0</div>
              <button data-attr="VIG" class="attr-inc">+</button>
            </div>
            <div style="font-size:12px;color:var(--muted);margin-top:8px">HP = 10 + (VIG × 3)</div>
          </div>

          <!-- INT -->
          <div class="attr">
            <h5>INT — Conhecimento e Lógica</h5>
            <div class="controls">
              <button data-attr="INT" class="attr-dec">-</button>
              <div class="val" id="INT">0</div>
              <button data-attr="INT" class="attr-inc">+</button>
            </div>
          </div>

          <!-- AUR -->
          <div class="attr">
            <h5>AUR — Energia Espiritual</h5>
            <div class="controls">
              <button data-attr="AUR" class="attr-dec">-</button>
              <div class="val" id="AUR">0</div>
              <button data-attr="AUR" class="attr-inc">+</button>
            </div>
            <div style="font-size:12px;color:var(--muted);margin-top:8px">PT = 6 + (AUR × 2) — mínimo 6, máximo 12</div>
          </div>

          <!-- CAR -->
          <div class="attr">
            <h5>CAR — Influência Social</h5>
            <div class="controls">
              <button data-attr="CAR" class="attr-dec">-</button>
              <div class="val" id="CAR">0</div>
              <button data-attr="CAR" class="attr-inc">+</button>
            </div>
          </div>
        </div>
      </div>

      <div class="block">
        <label style="display:block;margin-bottom:8px;color:var(--muted)">Perícias / Habilidades</label>
        <textarea id="skills" placeholder="Liste perícias e habilidades (uma por linha)"></textarea>
      </div>

      <div class="block">
        <label style="display:block;margin-bottom:8px;color:var(--muted)">Observações / Diário</label>
        <textarea id="notes" placeholder="Notas adicionais"></textarea>
      </div>

    </main>

    <!-- DIREITA: Inventário -->
    <aside class="inventory">
      <h4 style="margin:0 0 8px 0;font-family:'Cinzel Decorative', serif;font-size:16px">Inventário</h4>
      <ul class="inv-list" id="invList">
        <!-- itens vão aqui -->
      </ul>

      <div class="inv-add">
        <input id="invName" placeholder="Nome do item" />
        <button class="small-btn" id="invAddBtn">+ adicionar</button>
      </div>

      <div class="strange-msg" id="strangeMsg">"Você não consegue deixar de escutar algo..."</div>

    </aside>

  </div>

  <script>
    /* -----------------------------
       LOGICA INTERATIVA
       ----------------------------- */

    // valores iniciais
    const state = {
      attrs: {FOR:0, AGI:0, VIG:0, INT:0, AUR:0, CAR:0},
      hpMax:10,
      pv:10,
      ps:50,
      pt:6,
      inventory:[]
    };

    // helpers
    const clamp = (v, a, b) => Math.max(a, Math.min(b, v));

    // DOM refs
    const FORel = document.getElementById('FOR');
    const AGIel = document.getElementById('AGI');
    const VIGel = document.getElementById('VIG');
    const INTel = document.getElementById('INT');
    const AURel = document.getElementById('AUR');
    const CARel = document.getElementById('CAR');

    const pvDisplay = document.getElementById('pvDisplay');
    const psDisplay = document.getElementById('psDisplay');
    const ptDisplay = document.getElementById('ptDisplay');

    const portrait = document.getElementById('portrait');
    const strangeMsg = document.getElementById('strangeMsg');

    // messages quando PS < 25
    const strangePool = [
      'Você ouviu o seu nome em silêncio.',
      'Algo escreve na margem do seu pensamento.',
      'Não confie no que a ficha mostra agora.',
      'O reflexo não combina mais com você.'
    ];

    function recalcAll(){
      // HP
      const vig = state.attrs.VIG;
      state.hpMax = 10 + (vig * 3);
      state.pv = clamp(state.pv, 0, state.hpMax);

      // PT
      const aur = state.attrs.AUR;
      state.pt = clamp(6 + (aur * 2), 6, 12);

      // PS
      state.ps = clamp(state.ps, 0, 999);

      renderAll();
    }

    function renderAll(){
      // atributos
      FORel.textContent = state.attrs.FOR;
      AGIel.textContent = state.attrs.AGI;
      VIGel.textContent = state.attrs.VIG;
      INTel.textContent = state.attrs.INT;
      AURel.textContent = state.attrs.AUR;
      CARel.textContent = state.attrs.CAR;

      // vitais
      pvDisplay.textContent = state.pv + ' / ' + state.hpMax;
      psDisplay.textContent = state.ps;
      ptDisplay.textContent = state.pt;

      // portrait logic
      if(state.ps < 25){
        portrait.style.backgroundImage = "var(--portrait-insane)";
      } else if(state.pv < (state.hpMax/2)){
        portrait.style.backgroundImage = "var(--portrait-injured)";
      } else {
        portrait.style.backgroundImage = "var(--portrait-normal)";
      }

      // strange messages
      if(state.ps < 25){
        strangeMsg.style.display = 'block';
        strangeMsg.textContent = '"'+ strangePool[Math.floor(Math.random()*strangePool.length)] + '"';
      } else {
        strangeMsg.style.display = 'none';
      }

      renderInventory();
    }

    // inventory functions
    const invList = document.getElementById('invList');
    function renderInventory(){
      invList.innerHTML = '';
      state.inventory.forEach((it, idx)=>{
        const li = document.createElement('li');
        li.className = 'inv-item';
        li.innerHTML = `<div>${it}</div><div><button data-idx='${idx}' class='small-btn inv-del'>remover</button></div>`;
        invList.appendChild(li);
      });
    }

    // attribute buttons
    document.querySelectorAll('.attr-inc').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const a = btn.getAttribute('data-attr');
        const curr = state.attrs[a];
        if(curr < 3){
          state.attrs[a] = curr + 1;
          recalcAll();
        }
      });
    });
    document.querySelectorAll('.attr-dec').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const a = btn.getAttribute('data-attr');
        const curr = state.attrs[a];
        if(curr > 0){
          state.attrs[a] = curr - 1;
          recalcAll();
        }
      });
    });

    // PV / PS / PT manual adjustments
    document.getElementById('pvPlus').addEventListener('click', ()=>{ state.pv = clamp(state.pv+1, 0, state.hpMax); renderAll(); });
    document.getElementById('pvMinus').addEventListener('click', ()=>{ state.pv = clamp(state.pv-1, 0, state.hpMax); renderAll(); });

    document.getElementById('psPlus').addEventListener('click', ()=>{ state.ps = state.ps+1; renderAll(); });
    document.getElementById('psMinus').addEventListener('click', ()=>{ state.ps = Math.max(0, state.ps-1); renderAll(); });

    // PT adjustments
    document.getElementById('ptPlus').addEventListener('click', ()=>{ state.pt = clamp(state.pt+1, 6, 12); renderAll(); });
    document.getElementById('ptMinus').addEventListener('click', ()=>{ state.pt = clamp(state.pt-1, 6, 12); renderAll(); });

    // inventario add/remove
    document.getElementById('invAddBtn').addEventListener('click', ()=>{
      const name = document.getElementById('invName').value.trim();
      if(!name) return;
      state.inventory.push(name);
      document.getElementById('invName').value = '';
      renderAll();
    });

    invList.addEventListener('click', (e)=>{
      if(e.target.classList.contains('inv-del')){
        const idx = Number(e.target.getAttribute('data-idx'));
        state.inventory.splice(idx,1);
        renderAll();
      }
    });

    // initialize
    recalcAll();
  </script>
</body>
</html>
